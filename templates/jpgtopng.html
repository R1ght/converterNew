<html>
<head>
    <title>JPG to PNG</title>
</head>
<body>
    <h1>JPG to PNG</h1>
    <form>
        <input type="file" id="image" name="image">
        <br>
        <br>
        <button type="button" onclick="convertToPNG()">Convert to PNG</button>
    </form>
    <br>
    <div id="output"></div>
    <script>
        function convertToPNG() {
            var image = document.getElementById("image").files[0];
            var output = document.getElementById("output");
            var formData = new FormData();
            formData.append("image", image);
            if(!image) {
                output.innerHTML = "Please select an image";
                return;
            }
            if(image.type != "image/jpeg") {
                output.innerHTML = "Image is not in JPG format";
                return;
            }
            if(image.size > 5000000) {
                output.innerHTML = "Image size exceeds the limit of 5MB";
                return;
            }
            var xhr = new XMLHttpRequest();
            xhr.open("POST", "/api/jpgtopng", true);
            xhr.onreadystatechange = function() {
                if(xhr.readyState === 4 && xhr.status === 200) {
                    output.innerHTML = "Image converted successfully";
                    const response = xhr.response;
                        const blob = new Blob([response], {type: 'image/png'});

                        const url = URL.createObjectURL(blob);
                        const link = document.createElement('a');
                        link.href = url;
                        link.download = image.name.replace(/\.jp*g$/i, '.png');

                        link.click();
                }
            };
            xhr.send(formData);
        }
    </script>
</body>
</html>


<!--
<html>
<head>
    <title>JPG to PNG</title>
</head>
<body>
    <h1>JPG to PNG</h1>
    <form>
        <input type="file" id="image" name="image" accept="image/jpeg">
        <br>
        <br>
        <button type="button" onclick="convertToPNG()">Convert to PNG</button>
        <p id="error"></p>   
    </form>

    <script>
        function convertToPNG() {
          var image = document.getElementById("image").files[0];
          var error = document.getElementById("error");
    
          if (image) {
            if (image.type === "image/jpg" && image.size < 5000000) {
              var formData = new FormData();
              formData.append("image", image);
    
              fetch("/api/jpgtopng", {
                method: "POST",
                body: formData
              })
                .then(response => {
                  if (response.ok) {
                    response.blob().then(blob => {
                      var url = URL.createObjectURL(blob);
                      var a = document.createElement("a");
                      a.href = url;
                      a.download = "converted_image.png";
                      a.click();
                    });
                  } else {
                    error.textContent = "Error converting image";
                  }
                })
                .catch(error => {
                  error.textContent = "Error converting image";
                });
            } else {
              error.textContent = "Please select a JPG image less than 5MB";
            }
          } else {
            error.textContent = "Please select an image";
          }
        }
      </script>
    
    <script>
        function convertToPNG() {
            var image = document.getElementById("image").files[0];
            var output = document.getElementById("output");
            var formData = new FormData();
            formData.append("image", image);
            if(!image) {
                output.innerHTML = "Please select an image";
                return;
            }
            if(image.type != "image/jpeg") {
                output.innerHTML = "Image is not in JPG format";
                return;
            }
            if(image.size > 5000000) {
                output.innerHTML = "Image size exceeds the limit of 5MB";
                return;
            }
            var xhr = new XMLHttpRequest();
            xhr.open("POST", "/api/jpgtopng", true);
            xhr.onreadystatechange = function() {
                    if(xhr.readyState === 4 && xhr.status === 200) {
                        output.innerHTML = "Image converted successfully";
                        
                        const response = xhr.response;
                        const blob = new Blob([response], {type: 'image/png'});

                        const url = URL.createObjectURL(blob);
                        const link = document.createElement('a');
                        link.href = url;
                        link.download = 'converted_image.png';

                        link.click();
                    }
                };
            xhr.send(formData);
        }
    </script>
    
</body>
</html>

-->
